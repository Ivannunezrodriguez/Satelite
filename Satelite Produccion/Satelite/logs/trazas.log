28-11-2024 16-16-04 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
02-12-2024 17-18-32 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote -->  SELECT DISTINCT(ZTIPO_PLANTA), ZID, ZVARIEDAD, ZCODGOLDEN, UD_BASE FROM ZPLANTA_TIPO_VARIEDAD_CODGOLDEN  WHERE UD_BASE = 'PLANTAS'  AND ZCODGOLDEN = '2-ALBION'  ZVARIEDAD = 'ALBION'  AND ZTIPO_PLANTA = '2-' 
02-12-2024 17-19-36 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote -->  SELECT DISTINCT(ZTIPO_PLANTA), ZID, ZVARIEDAD, ZCODGOLDEN, UD_BASE FROM ZPLANTA_TIPO_VARIEDAD_CODGOLDEN  WHERE UD_BASE = 'PLANTAS'  AND ZCODGOLDEN = '2-ALBION'  ZVARIEDAD = 'ALBION'  AND ZTIPO_PLANTA = '2-' 
02-12-2024 17-44-46 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote -->   SELECT ZID , ZTIPO_PLANTA, ZDESCRIPTIPO FROM ZTIPOPLANTADESCRIP ORDER BY ZID WHERE ZDESCRIPTIPO = 'Frambuesa etiolo'
03-12-2024 08-36-34 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote -->  SELECT  ZID , ZTIPO_PLANTA, ZDESCRIPTIPO FROM ZTIPOPLANTADESCRIP WHERE
03-12-2024 08-37-53 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote -->  SELECT  ZID , ZTIPO_PLANTA, ZDESCRIPTIPO FROM ZTIPOPLANTADESCRIP WHERE
03-12-2024 09-01-17 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote -->  SELECT  ZID , ZTIPO_PLANTA, ZDESCRIPTIPO FROM ZTIPOPLANTADESCRIP WHERE
03-12-2024 09-15-43 = 9 - DESKTOP-BN3QMNC - Jose -  ExecuteNonQuery -->El nombre de columna 'ZNUMERO_PLANTA' no es válido..Password=Us3r95Pass;Persist Security Info=True;User ID=UserRio95;Initial Catalog=Satelite_Backup;Data Source=192.168.1.95 --> BuscaLote --> INSERT INTO ZBANDEJAS (ZTIPO_PLANTA, ZTIPO_FORMATO, ZNUMERO_PLANTA) Values ('88-', '88-', '88') 
12-12-2024 08-34-07 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 08-34-20 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
12-12-2024 08-36-06 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 08-36-21 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 08-36-21 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7  --> SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7 
12-12-2024 08-36-21 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 08-36-29 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 08-38-30 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
12-12-2024 08-38-33 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 08-38-48 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 08-38-48 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7  --> SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7 
12-12-2024 08-38-48 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 08-47-00 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 08-47-08 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
12-12-2024 08-47-11 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 08-47-26 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between '01/12/2024' and '11/12/2024'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 08-47-26 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7  --> SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7 
12-12-2024 08-47-26 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 08-54-17 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 09-04-43 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 09-05-02 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
12-12-2024 09-05-02 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 09-05-18 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 09-05-18 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7  --> SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7 
12-12-2024 09-05-18 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 09-15-30 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
12-12-2024 09-15-30 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 09-15-45 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 09-15-45 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130 --> SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130
12-12-2024 09-15-45 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 09-16-37 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 09-18-55 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 09-27-45 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 09-27-53 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
12-12-2024 09-27-53 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 09-28-08 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 09-28-08 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7  --> SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7 
12-12-2024 09-28-08 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 09-35-58 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 09-36-22 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
12-12-2024 09-36-22 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 09-36-37 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


12-12-2024 09-36-37 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7  --> SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7 
12-12-2024 09-36-38 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 11-01-22 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 12-47-55 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-12-2024 12-49-14 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-12-2024 08-46-06 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-12-2024 09-01-14 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-12-2024 09-01-22 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-12-2024 09-01-33 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-12-2024 09-01-41 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 22 --> 
13-12-2024 09-01-44 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 22 --> 
13-12-2024 09-01-57 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
13-12-2024 09-01-57 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-12-2024 09-02-12 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-12-2024 09-02-12 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7  --> SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7 
13-12-2024 09-02-17 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 22 --> 
13-12-2024 09-02-36 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-12-2024 09-02-52 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
13-12-2024 09-02-52 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-12-2024 09-03-07 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-12-2024 09-03-07 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7  --> SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7 
13-12-2024 09-04-10 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-12-2024 09-04-25 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
13-12-2024 09-04-25 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-12-2024 09-04-40 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-12-2024 09-04-40 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130 --> SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130
13-12-2024 09-06-20 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-12-2024 09-06-56 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
13-12-2024 09-06-56 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-12-2024 09-07-11 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE24].[dbo].[Lineas Facturacion] as A, [NET_VRE24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA24].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA24].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA24].[dbo].[Lineas Facturacion] as A, [NET_VIVA24].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-12-2024 09-07-11 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130 --> SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130
13-12-2024 09-08-20 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-12-2024 18-12-36 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 7 --> 
13-12-2024 18-56-33 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 7 --> 
16-12-2024 08-51-14 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-01-2025 18-59-24 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD  FROM Satelite_Backup.dbo.ZGRAFICAS WHERE  AÑO = '2023'  MESNUM = '01'  AND UNIDADES = 'PLANTAS'  GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES  ORDER BY MES, AÑO, MESNUM 
14-01-2025 09-06-19 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> 
14-01-2025 10-01-23 = 9 - DESKTOP-BN3QMNC - Jose -  ExecuteScalarSQL -->Sintaxis incorrecta cerca de la palabra clave 'SELECT'..Password=Us3r95Pass;Persist Security Info=True;User ID=UserRio95;Initial Catalog=Satelite_Backup;Data Source=192.168.1.95 --> BuscaLote --> SELECT CONSULTA FROM ZGRAFICAS WHERE ID =SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
FROM ZGRAFICAS
WHERE 
AÑO = 'NONE' 
AND MESNUM = 'NONE' 
AND UNIDADES = 'NONE' 
AND TIPO_FORM = 'NONE' 
GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 
ORDER BY MES, AÑO, MESNUM 
14-01-2025 10-08-35 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
FROM ZGRAFICAS
WHERE 
 
AND MESNUM = 'NONE' 
 
 
GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 
ORDER BY MES, AÑO, MESNUM 
14-01-2025 10-24-13 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> 
14-01-2025 10-41-46 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> 0
14-01-2025 11-04-36 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> 
14-01-2025 11-04-39 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> 
14-01-2025 11-12-07 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
 FROM Satelite_Backup.dbo.ZGRAFICAS
 WHERE 
 AÑO = '2024'
 UNIDADES = 'PLANTAS' 
 GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 
 ORDER BY MES, AÑO, MESNUM 

14-01-2025 11-47-17 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
 FROM Satelite_Backup.dbo.ZGRAFICAS
AND MES = '01'
WHERE AÑO = '2024'
AND UNIDADES = 'CAJAS'
AND MES = '01'
 GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 
 ORDER BY MES, AÑO, MESNUM 

14-01-2025 11-47-32 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
FROM ZGRAFICAS
AÑO = 'NONE' 
AND MESNUM = 'NONE' 
AND UNIDADES = 'NONE' 
AND TIPO_FORM = 'NONE' 
WHERE AÑO = '2024'
AND UNIDADES = 'CAJAS'
AND MES = '01'
GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 

14-01-2025 11-51-54 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
FROM ZGRAFICAS
AÑO = 'NONE' 
AND MESNUM = 'NONE' 
AND UNIDADES = 'NONE' 
AND TIPO_FORM = 'NONE' 
WHERE AÑO = '2024'
AND UNIDADES = 'PLANTAS'
AND MES = '01'
GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 

14-01-2025 11-52-11 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
FROM ZGRAFICAS
AÑO = 'NONE' 
AND MESNUM = 'NONE' 
AND UNIDADES = 'NONE' 
AND TIPO_FORM = 'NONE' 
AND MES = '01'
WHERE AÑO = '2024'
AND UNIDADES = 'PLANTAS'
AND MES = '01'
GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 

14-01-2025 11-52-33 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
FROM ZGRAFICAS
AÑO = 'NONE' 
AND MESNUM = 'NONE' 
AND UNIDADES = 'NONE' 
AND TIPO_FORM = 'NONE' 
WHERE AÑO = '2024'
AND UNIDADES = 'PLANTAS'
AND MES = '01'
GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 

14-01-2025 11-58-09 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> 
14-01-2025 11-58-17 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> 
14-01-2025 12-02-17 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> 
14-01-2025 12-04-16 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
FROM ZGRAFICAS
WHERE UNIDADES = 'PLANTAS'

AÑO = '2024' 
AND MESNUM = '02' 
AND UNIDADES = 'PLANTAS' 
GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 

14-01-2025 12-08-18 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
FROM ZGRAFICAS
WHERE UNIDADES = 'PLANTAS'

AÑO = '2024' 
AND MESNUM = '02' 
AND UNIDADES = 'PLANTAS' 
GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 

14-01-2025 12-15-49 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
 FROM Satelite_Backup.dbo.ZGRAFICAS
WHERE
 GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 
 ORDER BY MES, AÑO, MESNUM 

14-01-2025 12-15-54 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
 FROM Satelite_Backup.dbo.ZGRAFICAS
WHERE
 GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 
 ORDER BY MES, AÑO, MESNUM 

14-01-2025 12-16-37 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
 FROM Satelite_Backup.dbo.ZGRAFICAS
WHERE
 GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 
 ORDER BY MES, AÑO, MESNUM 

14-01-2025 12-16-40 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT MESNUM, MES, AÑO, VARIEDAD, UNIDADES, SUM(CONVERT(int, NUM_UNIDADES))  AS CANTIDAD 
 FROM Satelite_Backup.dbo.ZGRAFICAS
WHERE
 GROUP BY MES, AÑO, MESNUM, VARIEDAD, UNIDADES 
 ORDER BY MES, AÑO, MESNUM 

14-01-2025 16-32-37 = FicherosTemporal - El directorio  existe en --> C:\Rioeresma\Satelite\Satelite\uploads\Jose\
14-01-2025 16-32-58 = gvLista rowcommand -->  La ruta del fichero esta en http:///localhost:54462//Docs/5106/2024-07-15 Indefinido 300 0098 de B40254443.pdf
14-01-2025 16-33-35 = FicherosTemporal - El directorio  existe en --> C:\Rioeresma\Satelite\Satelite\uploads\Jose\
12-02-2025 18-24-35 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-02-2025 18-24-45 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
12-02-2025 18-30-55 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-24-01 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-24-09 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-24-15 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-24-18 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 22 --> 
13-02-2025 08-24-23 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 22 --> 
13-02-2025 08-24-24 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-24-38 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
13-02-2025 08-24-38 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-24-53 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-24-53 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7  --> SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7 
13-02-2025 08-24-59 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-25-20 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
13-02-2025 08-25-20 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-25-36 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-25-36 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130 --> SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130
13-02-2025 08-25-42 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-34-19 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
13-02-2025 08-35-36 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-36-11 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLote --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-36-12 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLote - SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130 --> SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130
13-02-2025 08-36-16 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-36-17 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
13-02-2025 08-36-17 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-36-32 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-36-32 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130 --> SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130
13-02-2025 08-36-38 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-36-59 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-37-10 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-47-26 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
13-02-2025 08-56-55 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-57-03 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta Query --> donde 4 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA

 --> 
13-02-2025 08-57-03 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-57-11 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-57-11 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7  --> SELECT ZCOMPARA  FROM ZPROCEDIMIENTOS WHERE ZID = 7 
13-02-2025 08-57-58 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold --> 

SELECT * FROM 
(
SELECT 
	   'VRE' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy') as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VRE25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VRE25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(CONVERT(date,GETDATE()), 'dd/MM/yyyy') as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy') as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy') as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy') as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VRE25].[dbo].[Lineas Facturacion] as A, [NET_VRE25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
UNION ALL
SELECT 
	   'VIVA' as ZEMPRESA
	   ,B.[Serie] as SERIE 
	  ,CONVERT( int, B.[Numero]) as NUMERO 
      ,FORMAT(CONVERT( datetime ,B.[Fecha]), 'dd/MM/yyyy')  as FECHA
      ,B.[Cliente Proveedor] as CLICODIGO
	  ,B.[Nombre Fiscal] AS NOMBREFISCAL
	  ,B.[Domicilio] + ' ' + B.[C postal] + ' ' + B.[Poblacion] + ' ' + (SELECT [TEXTO] FROM [NET_VARIOS].[dbo].[Paises]
	  WHERE CODIGO = B.Pais) as CLIDOMICILIO
      ,B.[CIF] as CLICIF
      ,B.[Pais] as CLIPAIS 
      ,CONVERT(DECIMAL(10,2),B.[Total Factura]) as IMPORTE
      ,B.[Observaciones] as INCOTERM
      ,B.[Comentario3] as FORMAPAGO
	  ,(SELECT [P Contacto] FROM [NET_VIVA25].[dbo].[Personas] where Contador = B.Contacto) as CONTACTO
	  --
	  ,A.[Linea] as LINEA
      ,A.[Producto] as PRODUCTO
	  ,'' as ZTIPO
	  ,'' as  ZVARIEDAD
	  ,'' as ZDESCRIPCION
	  ,'' as ZOBT
      ,CONVERT(DECIMAL(10,3),A.[Uds Servidas]) as UNIDADES
      ,CONVERT(DECIMAL(10,2),A.[PVP de la Unidad]) as PVPLINEA
      ,A.[MedidaServir] as MEDIDA
	  ,'' as ZNUMCAJAS
	  ,(SELECT [SubFamilia] FROM [NET_VIVA25].[dbo].[Articulos] where Codigo = A.[Producto]) as OBTENTOR
	  --
	  ,B.[DocumentosAdjuntos]  as DOC
      ,B.[ClaseOperacion] as CLASOPE
	  ,FORMAT(convert(date,GETDATE()), 'dd/MM/yyyy')  as ZFECHACONTRATO
      ,FORMAT(CONVERT( datetime ,B.[FechaRegistro]), 'dd/MM/yyyy')  as REGFECHA
	  ,FORMAT(B.[Ultima Modificacion], 'dd/MM/yyyy')  as ULTMOD
	  ,FORMAT(CONVERT( datetime ,B.[Fecha Impreso]), 'dd/MM/yyyy')  as REGFECHIMPR
      ,B.[CodigoUsuarioRegistro] as CODUSU
	  ,0 as ZKEY
 	  ,1013 as ZID_FLUJO
	  ,21 as ZID_ESTADO
	  ,CASE WHEN B.[DocumentosAdjuntos]  is null THEN 0
	   WHEN B.[DocumentosAdjuntos]  = '' THEN 0
	   ELSE 1
	   END as ZESTADO
	   ,'' as ZTIPO_PLANTA
  FROM [NET_VIVA25].[dbo].[Lineas Facturacion] as A, [NET_VIVA25].[dbo].[Cabecera Facturacion] as B
  where A.Tipo = 'O'
  and A.Tipo = B.Tipo
  and A.Serie = 'OFF'
  and [Realizado] = ''
  and [Desestimado] = ''
  and A.Serie =  B.Serie
  and A.Numero = B.Numero
  and substring(A.Producto,1,2) in ('1-', '2-', '3-', '4-', '5-', '6-', '7-', '9-', 'P-')
  --and B.[FechaRegistro] between 'DESDE#' and 'HASTA#'
  )  dum
order by ZEMPRESA, SERIE, NUMERO, LINEA


13-02-2025 08-57-59 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 4 Error:Error de base de datos. --> BuscaLoteGold - SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130 --> SELECT ZID, ZDESCRIPCION, ZNIVEL, ZROOT, ZKEY, ZVIEW, ZTABLENAME, ZTABLEOBJ, ZTIPO, ZESTADO, ZCONEXION, ZID_FLUJO  FROM ZARCHIVOS WHERE ZNIVEL <= 9 AND ZID = 130
13-02-2025 08-58-20 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
13-02-2025 08-58-21 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
25-02-2025 09-32-27 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
25-02-2025 09-32-33 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
25-02-2025 09-32-46 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
25-02-2025 09-32-50 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 22 --> 
25-02-2025 09-32-56 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 22 --> 
25-02-2025 09-33-08 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 22 --> 
25-02-2025 09-33-18 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 22 --> 
25-02-2025 09-33-34 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 22 --> 
25-02-2025 09-33-38 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
25-02-2025 09-33-45 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1
25-02-2025 09-33-46 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 31 Error:No se puede encontrar la tabla 0. --> BuscaLote - SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1 --> SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1
25-02-2025 09-33-48 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
25-02-2025 09-34-03 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
25-02-2025 09-34-21 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1
25-02-2025 09-34-21 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 31 Error:No se puede encontrar la tabla 0. --> BuscaLote - SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1 --> SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1
25-02-2025 09-34-23 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
25-02-2025 09-43-54 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
26-02-2025 08-56-47 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold -->  Select 'VRE' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VRE25].[dbo].[Cabecera Facturacion Compras] C, [NET_VRE25].[dbo].[Lineas Facturacion Compras] L, [NET_VRE25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas]  UNION ALL  Select 'VIVA' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VIVA25].[dbo].[Cabecera Facturacion Compras] C, [NET_VIVA25].[dbo].[Lineas Facturacion Compras] L, [NET_VIVA25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas] 
26-02-2025 08-57-02 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold -->  Select 'VRE' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VRE25].[dbo].[Cabecera Facturacion Compras] C, [NET_VRE25].[dbo].[Lineas Facturacion Compras] L, [NET_VRE25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas]  UNION ALL  Select 'VIVA' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VIVA25].[dbo].[Cabecera Facturacion Compras] C, [NET_VIVA25].[dbo].[Lineas Facturacion Compras] L, [NET_VIVA25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas] 
26-02-2025 08-57-02 = Error ZPEDIDOS_COMPRA --> Paso:2 -->Error:Error de base de datos. --> SQL: Select 'VRE' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VRE25].[dbo].[Cabecera Facturacion Compras] C, [NET_VRE25].[dbo].[Lineas Facturacion Compras] L, [NET_VRE25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas]  UNION ALL  Select 'VIVA' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VIVA25].[dbo].[Cabecera Facturacion Compras] C, [NET_VIVA25].[dbo].[Lineas Facturacion Compras] L, [NET_VIVA25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas] 
26-02-2025 08-57-52 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
26-02-2025 11-02-39 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->BuscaLoteGold -->  Select 'VRE' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VRE25].[dbo].[Cabecera Facturacion Compras] C, [NET_VRE25].[dbo].[Lineas Facturacion Compras] L, [NET_VRE25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas]  UNION ALL  Select 'VIVA' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VIVA25].[dbo].[Cabecera Facturacion Compras] C, [NET_VIVA25].[dbo].[Lineas Facturacion Compras] L, [NET_VIVA25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas] 
26-02-2025 11-02-54 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLoteGold -->Error relacionado con la red o específico de la instancia mientras se establecía una conexión con el servidor SQL Server. No se encontró el servidor o éste no estaba accesible. Compruebe que el nombre de la instancia es correcto y que SQL Server está configurado para admitir conexiones remotas. (provider: SQL Network Interfaces, error: 26 - Error al buscar el servidor o instancia especificado) --> BuscaLoteGold -->  Select 'VRE' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VRE25].[dbo].[Cabecera Facturacion Compras] C, [NET_VRE25].[dbo].[Lineas Facturacion Compras] L, [NET_VRE25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas]  UNION ALL  Select 'VIVA' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VIVA25].[dbo].[Cabecera Facturacion Compras] C, [NET_VIVA25].[dbo].[Lineas Facturacion Compras] L, [NET_VIVA25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas] 
26-02-2025 11-02-54 = Error ZPEDIDOS_COMPRA --> Paso:2 -->Error:Error de base de datos. --> SQL: Select 'VRE' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VRE25].[dbo].[Cabecera Facturacion Compras] C, [NET_VRE25].[dbo].[Lineas Facturacion Compras] L, [NET_VRE25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas]  UNION ALL  Select 'VIVA' AS EMPRESA, C.[Cliente Proveedor] as CLIENTEPROVEEDOR, C.[Nombre Fiscal] as NOMBREFISCAL, C.[Fecha Entrega] as FECHAENTREGA,  C.Serie as SERIE_PED, C.Numero as NUMERO, L.Línea as LINEA, L.Producto as PRODUCTO, L.Descripcion as DESCRIPCION, L.[Uds Pedidas] as UDSPEDIDAS, L.[Uds Servidas] as UDSSERVIDAS, ([Uds Pedidas] -[Uds Servidas]) as UDSPENDIENTES, A.[Familia] as FAMILIA   FROM [NET_VIVA25].[dbo].[Cabecera Facturacion Compras] C, [NET_VIVA25].[dbo].[Lineas Facturacion Compras] L, [NET_VIVA25].[dbo].[Articulos] A  WHERE L.tipo = 'P'  AND C.tipo = L.tipo  AND C.Serie = L.Serie  AND C.Numero = L.Numero  AND C.Realizado = 0  AND L.Producto = A.Codigo  AND A.Familia in('000000','100000','200000','220000','300000','310000','320000','400000','410000','500000','600000','620000','700000','721000','722000','900000','Codigo')  AND L.[Uds Servidas] < L.[Uds Pedidas] 
26-02-2025 11-58-41 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
26-02-2025 12-00-36 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1
26-02-2025 12-00-36 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 31 Error:No se puede encontrar la tabla 0. --> BuscaLote - SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1 --> SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1
26-02-2025 12-00-39 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
26-02-2025 12-00-46 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1
26-02-2025 12-00-46 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 31 Error:No se puede encontrar la tabla 0. --> BuscaLote - SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1 --> SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1
26-02-2025 12-01-54 = 9 - DESKTOP-BN3QMNC - Jose -  BuscaLote -->BuscaLote --> SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1
26-02-2025 12-01-54 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 31 Error:No se puede encontrar la tabla 0. --> BuscaLote - SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1 --> SELECT ZID FROM OFERTA_CABECERA WHERE ZID_FLUJO ='1013' AND ZID_ARCHIVO = '130' AND ZORDEN = 1
26-02-2025 12-09-25 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
26-02-2025 12-11-36 = 9 - DESKTOP-BN3QMNC - Jose -  ExecuteNonQuery -->El nombre de columna 'ZID_ARCHIVO' no es válido..Password=Us3r95Pass;Persist Security Info=True;User ID=UserRio95;Initial Catalog=Satelite_Backup;Data Source=192.168.1.95 --> BuscaLote --> DELETE FROM OFERTA_CABECERA WHERE ZID_ESTADO = '21' AND ZID_ARCHIVO = '130' AND ZID_FLUJO = '1013'
26-02-2025 12-11-36 = 9 - DESKTOP-BN3QMNC - Jose -  btGralCnsulta -->  Donde = 31 Error:Error de base de datos. --> BuscaLote - DELETE FROM OFERTA_CABECERA WHERE ZID_ESTADO = '21' AND ZID_ARCHIVO = '130' AND ZID_FLUJO = '1013' --> DELETE FROM OFERTA_CABECERA WHERE ZID_ESTADO = '21' AND ZID_ARCHIVO = '130' AND ZID_FLUJO = '1013'
26-02-2025 12-11-40 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
26-02-2025 12-30-42 = 9 - DESKTOP-BN3QMNC - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
21-03-2025 13-10-30 = 9 - DESKTOP-BN3QMNC - Jose -  AltaArchivos.Page_load --> Envia a Server.Transfer(Login.aspx). La Sesion:8EVgRN111dp0JVQeb8D33LUjx1biaGDjQ0swpdVVh/M= --> 
21-03-2025 13-14-42 = 9 - DESKTOP-BN3QMNC - Jose -  AltaArchivos.Page_load --> Envia a Server.Transfer(Login.aspx). La Sesion:8EVgRN111dp0JVQeb8D33LUjx1biaGDjQ0swpdVVh/M= --> 
22-04-2025 10-54-11 = 9 - Wanapito_i7 - Jose -  AltaArchivos.Page_load --> Envia a Server.Transfer(Login.aspx). La Sesion:NCZLaAfWMAJ0JVQeb8D33KtotR/soxukQ0swpdVVh/M= --> 
22-04-2025 11-29-44 = 9 - Wanapito_i7 - Jose -  AltaArchivos.Page_load --> Envia a Server.Transfer(Login.aspx). La Sesion:NCZLaAfWMAJ0JVQeb8D33KtotR/soxukQ0swpdVVh/M= --> 
22-04-2025 11-30-07 = 9 - Wanapito_i7 - Jose -  DrFlujoEstado_Changed ID :0 --> SQL:SELECT ZFIRMA  FROM ZESTADOSFLUJO WHERE ZID = 21 --> 
